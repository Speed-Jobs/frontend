openapi: 3.0.3

info:
  title: 채용 일정 분석 시스템 API 명세서
  version: 1.0.0
  description: |
    채용 일정 분석 시스템 백엔드 연동을 위한 API 명세서입니다.
    경쟁사 채용 일정 조회, 사용자 일정 관리, 경쟁 강도 분석, 전략적 인사이트 제공 등의 기능을 포함합니다.
    모든 응답은 공통 래퍼(status, code, message, data)를 따릅니다.

servers:
  - url: https://speedjobs-backend.skala25a.project.skala-ai.com/api/v1
    description: Production server
  - url: http://localhost:8080/api/v1
    description: Local development server

tags:
  - name: Recruitment Schedule
    description: 채용 일정 조회 및 관리
  - name: User Schedule
    description: 사용자 일정 관리
  - name: Analysis
    description: 채용 일정 분석 및 인사이트

paths:
  /recruitment-schedule/companies:
    get:
      tags:
        - Recruitment Schedule
      summary: 회사별 채용 일정 조회
      description: |
        경쟁사들의 채용 일정을 조회합니다.
        신입/경력 구분, 실제 공고/예측치 구분, 날짜 범위 필터링을 지원합니다.
      operationId: getCompanySchedules
      parameters:
        - in: query
          name: type
          required: false
          description: 채용 유형 (신입/경력)
          schema:
            type: string
            enum:
              - 신입
              - 경력
            default: 신입
          example: 신입
        - in: query
          name: data_type
          required: false
          description: "데이터 유형 (actual: 실제 공고, predicted: 예측치, all: 전체)"
          schema:
            type: string
            enum:
              - actual
              - predicted
              - all
            default: all
          example: actual
        - in: query
          name: start_date
          required: false
          description: 시작일 (YYYY-MM-DD 형식)
          schema:
            type: string
            format: date
            pattern: '^\d{4}-\d{2}-\d{2}$'
          example: "2025-01-01"
        - in: query
          name: end_date
          required: false
          description: 종료일 (YYYY-MM-DD 형식)
          schema:
            type: string
            format: date
            pattern: '^\d{4}-\d{2}-\d{2}$'
          example: "2025-12-31"
        - in: query
          name: company_ids
          required: false
          description: 특정 회사 ID 리스트 (쉼표 구분)
          schema:
            type: string
          example: "1,2,3"
      responses:
        '200':
          description: 성공적으로 채용 일정 목록을 반환합니다.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CompanySchedulesResponse'
              examples:
                신입공고예시:
                  summary: 신입 공고 일정 예시
                  value:
                    status: 200
                    code: "SUCCESS"
                    message: "회사별 채용 일정 조회 성공"
                    data:
                      schedules:
                        - id: "1"
                          company_id: 3
                          company_name: "삼성전자"
                          company_key: "samsung"
                          color: "#1e40af"
                          type: "신입"
                          data_type: "actual"
                          stages:
                            - id: "1-1"
                              stage: "서류접수"
                              start_date: "2025-01-01"
                              end_date: "2025-01-07"
                            - id: "1-2"
                              stage: "필기시험"
                              start_date: "2025-01-10"
                              end_date: "2025-01-10"
                            - id: "1-3"
                              stage: "1차 면접"
                              start_date: "2025-01-13"
                              end_date: "2025-01-14"
                        - id: "2"
                          company_id: 4
                          company_name: "LG전자"
                          company_key: "lg"
                          color: "#dc2626"
                          type: "신입"
                          data_type: "predicted"
                          stages:
                            - id: "2-1"
                              stage: "서류접수"
                              start_date: "2025-01-05"
                              end_date: "2025-01-12"
                            - id: "2-2"
                              stage: "1차 면접"
                              start_date: "2025-01-15"
                              end_date: "2025-01-16"
        '400':
          description: 잘못된 요청 파라미터
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: 서버 내부 오류
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /recruitment-schedule/companies/{companyId}:
    get:
      tags:
        - Recruitment Schedule
      summary: 특정 회사 채용 일정 조회
      description: 특정 회사의 채용 일정을 상세 조회합니다.
      operationId: getCompanyScheduleById
      parameters:
        - in: path
          name: companyId
          required: true
          description: 회사 ID
          schema:
            type: integer
          example: 3
        - in: query
          name: type
          required: false
          description: 채용 유형 (신입/경력)
          schema:
            type: string
            enum:
              - 신입
              - 경력
          example: 신입
        - in: query
          name: start_date
          required: false
          description: 시작일 (YYYY-MM-DD 형식)
          schema:
            type: string
            format: date
          example: "2025-01-01"
        - in: query
          name: end_date
          required: false
          description: 종료일 (YYYY-MM-DD 형식)
          schema:
            type: string
            format: date
          example: "2025-12-31"
      responses:
        '200':
          description: 성공적으로 채용 일정을 반환합니다.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CompanyScheduleResponse'
        '404':
          description: 해당 회사의 채용 일정을 찾을 수 없습니다.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /recruitment-schedule/competition-intensity:
    get:
      tags:
        - Analysis
      summary: 날짜별 경쟁 강도 분석
      description: |
        특정 기간 동안 날짜별로 동시에 진행되는 채용 일정의 수를 분석하여 경쟁 강도를 제공합니다.
      operationId: getCompetitionIntensity
      parameters:
        - in: query
          name: start_date
          required: true
          description: 시작일 (YYYY-MM-DD 형식)
          schema:
            type: string
            format: date
            pattern: '^\d{4}-\d{2}-\d{2}$'
          example: "2025-01-01"
        - in: query
          name: end_date
          required: true
          description: 종료일 (YYYY-MM-DD 형식)
          schema:
            type: string
            format: date
            pattern: '^\d{4}-\d{2}-\d{2}$'
          example: "2025-01-31"
        - in: query
          name: type
          required: false
          description: 채용 유형 (신입/경력)
          schema:
            type: string
            enum:
              - 신입
              - 경력
          example: 신입
      responses:
        '200':
          description: 성공적으로 경쟁 강도 분석 결과를 반환합니다.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CompetitionIntensityResponse'
              example:
                status: 200
                code: "SUCCESS"
                message: "경쟁 강도 분석 성공"
                data:
                  period:
                    start_date: "2025-01-01"
                    end_date: "2025-01-31"
                  max_overlaps: 5
                  daily_intensity:
                    - date: "2025-01-01"
                      overlap_count: 2
                      companies:
                        - company_id: 3
                          company_name: "삼성전자"
                        - company_id: 4
                          company_name: "LG전자"
                    - date: "2025-01-05"
                      overlap_count: 3
                      companies:
                        - company_id: 3
                          company_name: "삼성전자"
                        - company_id: 4
                          company_name: "LG전자"
                        - company_id: 5
                          company_name: "SK텔레콤"
                    - date: "2025-01-10"
                      overlap_count: 5
                      companies:
                        - company_id: 3
                          company_name: "삼성전자"
                        - company_id: 4
                          company_name: "LG전자"
                        - company_id: 5
                          company_name: "SK텔레콤"
                        - company_id: 6
                          company_name: "카카오"
                        - company_id: 7
                          company_name: "네이버"

  /recruitment-schedule/user/pins:
    get:
      tags:
        - User Schedule
      summary: 사용자 일정 조회
      description: 현재 사용자가 등록한 채용 일정(핀)을 조회합니다.
      operationId: getUserPins
      security:
        - bearerAuth: []
      responses:
        '200':
          description: 성공적으로 사용자 일정 목록을 반환합니다.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserPinsResponse'
              example:
                status: 200
                code: "SUCCESS"
                message: "사용자 일정 조회 성공"
                data:
                  pins:
                    - id: "pin-1"
                      type: "서류 접수"
                      date: "2025-01-05"
                      end_date: "2025-01-12"
                    - id: "pin-2"
                      type: "인적성"
                      date: "2025-01-15"
                      end_date: null
                    - id: "pin-3"
                      type: "1차 면접"
                      date: "2025-01-20"
                      end_date: "2025-01-21"
    post:
      tags:
        - User Schedule
      summary: 사용자 일정 추가
      description: 새로운 채용 일정(핀)을 추가합니다.
      operationId: createUserPin
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateUserPinRequest'
            examples:
              단일일정:
                summary: 단일 일정 추가
                value:
                  type: "서류 접수"
                  date: "2025-01-05"
                  end_date: null
              기간일정:
                summary: 기간 일정 추가
                value:
                  type: "서류 접수"
                  date: "2025-01-05"
                  end_date: "2025-01-12"
              여러일정:
                summary: 여러 일정 한번에 추가
                value:
                  pins:
                    - type: "서류 접수"
                      date: "2025-01-05"
                      end_date: "2025-01-12"
                    - type: "인적성"
                      date: "2025-01-15"
                      end_date: null
                    - type: "1차 면접"
                      date: "2025-01-20"
                      end_date: "2025-01-21"
      responses:
        '201':
          description: 성공적으로 일정이 추가되었습니다.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserPinsResponse'
        '400':
          description: 잘못된 요청 데이터
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    delete:
      tags:
        - User Schedule
      summary: 사용자 일정 전체 삭제
      description: 현재 사용자의 모든 채용 일정을 삭제합니다.
      operationId: deleteAllUserPins
      security:
        - bearerAuth: []
      responses:
        '200':
          description: 성공적으로 모든 일정이 삭제되었습니다.
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: integer
                    example: 200
                  code:
                    type: string
                    example: "SUCCESS"
                  message:
                    type: string
                    example: "사용자 일정 전체 삭제 성공"
                  data:
                    type: object
                    nullable: true

  /recruitment-schedule/user/pins/{pinId}:
    put:
      tags:
        - User Schedule
      summary: 사용자 일정 수정
      description: 기존 채용 일정(핀)을 수정합니다.
      operationId: updateUserPin
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: pinId
          required: true
          description: 핀 ID
          schema:
            type: string
          example: "pin-1"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateUserPinRequest'
      responses:
        '200':
          description: 성공적으로 일정이 수정되었습니다.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserPinResponse'
        '404':
          description: 해당 일정을 찾을 수 없습니다.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    delete:
      tags:
        - User Schedule
      summary: 사용자 일정 삭제
      description: 채용 일정(핀)을 삭제합니다.
      operationId: deleteUserPin
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: pinId
          required: true
          description: 핀 ID
          schema:
            type: string
          example: "pin-1"
      responses:
        '200':
          description: 성공적으로 일정이 삭제되었습니다.
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: integer
                    example: 200
                  code:
                    type: string
                    example: "SUCCESS"
                  message:
                    type: string
                    example: "사용자 일정 삭제 성공"
                  data:
                    type: object
                    nullable: true
        '404':
          description: 해당 일정을 찾을 수 없습니다.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /recruitment-schedule/insights:
    post:
      tags:
        - Analysis
      summary: 채용 일정 인사이트 분석
      description: |
        사용자 일정과 경쟁사 일정을 비교하여 전략적 인사이트를 제공합니다.
        서류 접수 기간 경쟁도, 면접 일정 충돌, 최적 타이밍 등을 분석합니다.
      operationId: getRecruitmentInsights
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/InsightsRequest'
            example:
              user_pins:
                - type: "서류 접수"
                  date: "2025-01-05"
                  end_date: "2025-01-12"
                - type: "인적성"
                  date: "2025-01-15"
                  end_date: null
                - type: "1차 면접"
                  date: "2025-01-20"
                  end_date: "2025-01-21"
              analysis_period:
                start_date: "2025-01-01"
                end_date: "2025-01-31"
      responses:
        '200':
          description: 성공적으로 인사이트 분석 결과를 반환합니다.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InsightsResponse'
              example:
                status: 200
                code: "SUCCESS"
                message: "채용 일정 인사이트 분석 성공"
                data:
                  insights:
                    - type: "warning"
                      phase: "서류 접수 기간"
                      message: "서류 접수 기간 중 높은 경쟁도 (3개 기업). 지원자 수가 감소할 수 있습니다. 접수 기간 연장 또는 채용 브랜딩 강화를 고려하세요."
                      companies:
                        - "삼성전자"
                        - "LG전자"
                        - "SK텔레콤"
                    - type: "success"
                      phase: "인적성"
                      message: "인적성 검사가 경쟁이 적은 시기에 예정되어 있습니다. 지원자 참여율이 높을 것으로 예상됩니다."
                      companies: []
                    - type: "info"
                      phase: "전체 일정"
                      message: "채용 프로세스가 16일 소요됩니다. 빠른 일정으로 경쟁사보다 먼저 지원자를 확보할 수 있습니다."
                      companies: []
                  summary:
                    total_duration_days: 16
                    high_competition_days: 3
                    optimal_days: 5
                    risk_level: "medium"

components:
  schemas:
    CompanySchedulesResponse:
      type: object
      required:
        - status
        - code
        - message
        - data
      properties:
        status:
          type: integer
          description: HTTP 상태 코드
          example: 200
        code:
          type: string
          description: 응답 코드
          example: "SUCCESS"
        message:
          type: string
          description: 응답 메시지
          example: "회사별 채용 일정 조회 성공"
        data:
          type: object
          properties:
            schedules:
              type: array
              items:
                $ref: '#/components/schemas/CompanySchedule'

    CompanyScheduleResponse:
      type: object
      required:
        - status
        - code
        - message
        - data
      properties:
        status:
          type: integer
          example: 200
        code:
          type: string
          example: "SUCCESS"
        message:
          type: string
          example: "회사별 채용 일정 조회 성공"
        data:
          $ref: '#/components/schemas/CompanySchedule'

    CompanySchedule:
      type: object
      required:
        - id
        - company_id
        - company_name
        - type
        - stages
      properties:
        id:
          type: string
          description: 일정 ID
          example: "1"
        company_id:
          type: integer
          description: 회사 ID
          example: 3
        company_name:
          type: string
          description: 회사명 (한글)
          example: "삼성전자"
        company_key:
          type: string
          description: 회사 키 (프론트엔드에서 사용)
          example: "samsung"
        color:
          type: string
          description: 색상 코드 (HEX)
          example: "#1e40af"
        type:
          type: string
          enum:
            - 신입
            - 경력
          description: 채용 유형
          example: "신입"
        data_type:
          type: string
          enum:
            - actual
            - predicted
          description: 데이터 유형 (실제 공고/예측치)
          example: "actual"
        stages:
          type: array
          description: 채용 단계 목록
          items:
            $ref: '#/components/schemas/ScheduleStage'

    ScheduleStage:
      type: object
      required:
        - id
        - stage
        - start_date
        - end_date
      properties:
        id:
          type: string
          description: 단계 ID
          example: "1-1"
        stage:
          type: string
          description: 채용 단계명
          enum:
            - 서류접수
            - 서류전형
            - 인적성검사
            - 필기시험
            - 1차 면접
            - 2차 면접
            - 3차 면접
            - 최종 면접
            - 합격자 발표
          example: "서류접수"
        start_date:
          type: string
          format: date
          description: 시작일 (YYYY-MM-DD)
          example: "2025-01-01"
        end_date:
          type: string
          format: date
          description: 종료일 (YYYY-MM-DD)
          example: "2025-01-07"

    CompetitionIntensityResponse:
      type: object
      required:
        - status
        - code
        - message
        - data
      properties:
        status:
          type: integer
          example: 200
        code:
          type: string
          example: "SUCCESS"
        message:
          type: string
          example: "경쟁 강도 분석 성공"
        data:
          type: object
          properties:
            period:
              type: object
              properties:
                start_date:
                  type: string
                  format: date
                end_date:
                  type: string
                  format: date
            max_overlaps:
              type: integer
              description: 최대 동시 진행 회사 수
              example: 5
            daily_intensity:
              type: array
              items:
                type: object
                properties:
                  date:
                    type: string
                    format: date
                  overlap_count:
                    type: integer
                    description: 해당 날짜에 동시 진행되는 회사 수
                  companies:
                    type: array
                    items:
                      type: object
                      properties:
                        company_id:
                          type: integer
                        company_name:
                          type: string

    UserPinsResponse:
      type: object
      required:
        - status
        - code
        - message
        - data
      properties:
        status:
          type: integer
          example: 200
        code:
          type: string
          example: "SUCCESS"
        message:
          type: string
          example: "사용자 일정 조회 성공"
        data:
          type: object
          properties:
            pins:
              type: array
              items:
                $ref: '#/components/schemas/UserPin'

    UserPinResponse:
      type: object
      required:
        - status
        - code
        - message
        - data
      properties:
        status:
          type: integer
          example: 200
        code:
          type: string
          example: "SUCCESS"
        message:
          type: string
          example: "사용자 일정 조회 성공"
        data:
          $ref: '#/components/schemas/UserPin'

    UserPin:
      type: object
      required:
        - id
        - type
        - date
      properties:
        id:
          type: string
          description: 핀 ID
          example: "pin-1"
        type:
          type: string
          enum:
            - 서류 접수
            - 인적성
            - 1차 면접
            - 2차 면접
            - 3차 면접
          description: 일정 유형
          example: "서류 접수"
        date:
          type: string
          format: date
          description: 일정 날짜 (YYYY-MM-DD)
          example: "2025-01-05"
        end_date:
          type: string
          format: date
          nullable: true
          description: 종료일 (기간 일정인 경우, YYYY-MM-DD)
          example: "2025-01-12"

    CreateUserPinRequest:
      type: object
      oneOf:
        - type: object
          required:
            - type
            - date
          properties:
            type:
              type: string
              enum:
                - 서류 접수
                - 인적성
                - 1차 면접
                - 2차 면접
                - 3차 면접
            date:
              type: string
              format: date
            end_date:
              type: string
              format: date
              nullable: true
        - type: object
          required:
            - pins
          properties:
            pins:
              type: array
              items:
                type: object
                required:
                  - type
                  - date
                properties:
                  type:
                    type: string
                    enum:
                      - 서류 접수
                      - 인적성
                      - 1차 면접
                      - 2차 면접
                      - 3차 면접
                  date:
                    type: string
                    format: date
                  end_date:
                    type: string
                    format: date
                    nullable: true

    UpdateUserPinRequest:
      type: object
      required:
        - type
        - date
      properties:
        type:
          type: string
          enum:
            - 서류 접수
            - 인적성
            - 1차 면접
            - 2차 면접
            - 3차 면접
        date:
          type: string
          format: date
        end_date:
          type: string
          format: date
          nullable: true

    InsightsRequest:
      type: object
      required:
        - user_pins
      properties:
        user_pins:
          type: array
          description: 사용자 일정 목록
          items:
            type: object
            required:
              - type
              - date
            properties:
              type:
                type: string
                enum:
                  - 서류 접수
                  - 인적성
                  - 1차 면접
                  - 2차 면접
                  - 3차 면접
              date:
                type: string
                format: date
              end_date:
                type: string
                format: date
                nullable: true
        analysis_period:
          type: object
          description: 분석 기간 (선택사항, 없으면 자동 계산)
          properties:
            start_date:
              type: string
              format: date
            end_date:
              type: string
              format: date

    InsightsResponse:
      type: object
      required:
        - status
        - code
        - message
        - data
      properties:
        status:
          type: integer
          example: 200
        code:
          type: string
          example: "SUCCESS"
        message:
          type: string
          example: "채용 일정 인사이트 분석 성공"
        data:
          type: object
          properties:
            insights:
              type: array
              items:
                type: object
                properties:
                  type:
                    type: string
                    enum:
                      - warning
                      - success
                      - info
                    description: 인사이트 유형
                  phase:
                    type: string
                    description: 채용 단계
                  message:
                    type: string
                    description: 인사이트 메시지
                  companies:
                    type: array
                    items:
                      type: string
                    description: 관련 회사 목록
            summary:
              type: object
              properties:
                total_duration_days:
                  type: integer
                  description: 전체 채용 프로세스 소요 일수
                high_competition_days:
                  type: integer
                  description: 높은 경쟁이 예상되는 일수
                optimal_days:
                  type: integer
                  description: 최적의 타이밍 일수
                risk_level:
                  type: string
                  enum:
                    - low
                    - medium
                    - high
                  description: 전체 위험도

    ErrorResponse:
      type: object
      required:
        - status
        - code
        - message
      properties:
        status:
          type: integer
          description: HTTP 상태 코드
          example: 400
        code:
          type: string
          description: 에러 코드
          example: "BAD_REQUEST"
        message:
          type: string
          description: 에러 메시지
          example: "잘못된 요청 파라미터입니다."
        errors:
          type: array
          description: 상세 에러 정보 (선택사항)
          items:
            type: object
            properties:
              field:
                type: string
                description: 에러가 발생한 필드명
              message:
                type: string
                description: 에러 메시지

  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT 토큰 인증 (사용자 일정 관리 API에 필요)
